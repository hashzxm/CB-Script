<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Run Prediction Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* gray-100 */
        }
        .card {
            background-color: white;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .highlight {
            background-color: #d1fae5; /* green-200 */
            font-weight: 600;
        }
        .highlight .player-name {
            color: #065f46; /* green-800 */
        }
        .low-data {
            color: #6b7280; /* gray-500 */
            font-style: italic;
        }
        .table-header th {
            background-color: #f9fafb; /* gray-50 */
        }
        .player-row:hover {
            background-color: #f9fafb; /* gray-50 */
        }
        .toggle-btn {
            transition: background-color 0.3s, color 0.3s;
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">Home Run Prediction Report</h1>
            <p class="text-gray-600 mt-2">August 2, 2025</p>
            <button id="toggle-highlight-btn" class="mt-6 px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 toggle-btn">
                Toggle High Probability Players
            </button>
        </header>

        <main id="report-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Game cards will be injected here by JavaScript -->
        </main>
        
        <div id="no-data-message" class="hidden text-center py-16">
            <p class="text-xl text-gray-500">No high probability players found.</p>
        </div>

    </div>

    <script>
        // Raw text data from the report
        const reportText = `
================================================================================
                   HOME RUN PREDICTION REPORT FOR 2025-08-02                    
================================================================================
GAME: Dodgers @ Rays (1:10 PM ET)
--------------------------------------------------------------------------------
  Rays Batters vs. Blake Snell (Low Data)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Yandy Díaz                |     Low Data    |      3.19%     
  Ha-Seong Kim              |     Low Data    |      5.25%     
  Brandon Lowe              |     Low Data    |      47.84%    
  Junior Caminero           |     Low Data    |      51.21%    
  Christopher Morel         |     Low Data    |      33.82%    
  Josh Lowe                 |     Low Data    |      18.95%    
  Jonny DeLuca              |     Low Data    |      2.62%     
  Taylor Walls              |     Low Data    |      3.33%     
  Hunter Feduccia           |     Low Data    |      4.58%     

--------------------------------------------------------------------------------
  Dodgers Batters vs. Drew Rasmussen (Last 90d: 129 PA, 18.6% K, 0.115 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Shohei Ohtani             |      83.56%     |      77.88%    
  Freddie Freeman           |      19.10%     |      63.92%    
  Andy Pages                |      10.68%     |      37.96%    
  Michael Conforto          |      8.84%      |      65.44%    
  Tommy Edman               |      0.19%      |      5.93%     
  Mookie Betts              |      0.15%      |      22.74%    
  Teoscar Hernández         |      0.10%      |      86.81%    
  Will Smith                |     Low Data    |     Low Data   

================================================================================
GAME: Orioles @ Cubs (2:20 PM ET)
--------------------------------------------------------------------------------
  Cubs Batters vs. Tomoyuki Sugano (Last 90d: 167 PA, 17.4% K, 0.160 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Pete Crow-Armstrong       |      94.15%     |      78.21%    
  Seiya Suzuki              |      15.20%     |      87.48%    
  Kyle Tucker               |      14.56%     |      90.20%    
  Michael Busch             |      10.39%     |      87.55%    
  Ian Happ                  |      5.78%      |      90.17%    
  Dansby Swanson            |      3.24%      |      21.46%    
  Carson Kelly              |      1.78%      |      84.13%    
  Matt Shaw                 |      0.44%      |      42.90%    
  Nico Hoerner              |      0.04%      |      15.60%    

--------------------------------------------------------------------------------
  Orioles Batters vs. Matt Boyd (Last 90d: 253 PA, 22.5% K, 0.153 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Jackson Holliday          |      60.24%     |      6.53%     
  Colton Cowser             |      41.45%     |      78.22%    
  Coby Mayo                 |      1.32%      |      1.41%     
  Dylan Carlson             |      0.89%      |      65.43%    
  Gunnar Henderson          |      0.65%      |      14.76%    
  Adley Rutschman           |      0.39%      |      76.79%    
  Jordan Westburg           |      0.00%      |      65.55%    
  Tyler O'Neill             |      0.00%      |      93.70%    

================================================================================
GAME: Royals @ Blue Jays (3:07 PM ET)
--------------------------------------------------------------------------------
  Blue Jays Batters vs. Noah Cameron (Last 90d: 219 PA, 23.3% K, 0.118 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Bo Bichette               |      96.07%     |      1.48%     
  Ernie Clement             |      53.45%     |      53.85%    
  Ty France                 |      38.98%     |      3.52%     
  Daulton Varsho            |      0.48%      |      53.84%    
  Tyler Heineman            |      0.01%      |      59.63%    
  Addison Barger            |      0.01%      |      1.09%     
  Vladimir Guerrero         |      0.00%      |      27.65%    
  Leo Jimenez               |      0.00%      |      6.29%     
  Davis Schneider           |      0.00%      |      17.30%    

--------------------------------------------------------------------------------
  Royals Batters vs. Max Scherzer (Last 90d: 59 PA, 40.7% K, 0.093 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Randal Grichuk            |      33.32%     |      51.58%    
  Jonathan India            |      11.19%     |      49.67%    
  Salvador Pérez            |      6.46%      |      84.24%    
  Adam Frazier              |      0.10%      |      0.99%     
  Mike Yastrzemski          |      0.08%      |      35.46%    
  Kyle Isbel                |      0.08%      |      12.94%    
  Vinnie Pasquantino        |      0.04%      |      61.13%    
  Maikel García             |      0.01%      |      15.00%    
  Bobby Witt                |      0.00%      |      89.22%    
        `;

        /**
         * Parses the raw text of the home run report into a structured JavaScript object.
         * @param {string} text - The raw text content of the report.
         * @returns {Array<Object>} An array of game objects, each containing details and player stats.
         */
        function parseReport(text) {
            const games = [];
            const gameBlocks = text.split('================================================================================').filter(b => b.trim().startsWith('GAME:'));

            gameBlocks.forEach(block => {
                const lines = block.trim().split('\n');
                const gameTitle = lines.find(line => line.startsWith('GAME:')).replace('GAME: ', '').trim();
                
                const teamSections = block.split('--------------------------------------------------------------------------------').slice(1);
                const teamsData = [];

                teamSections.forEach(section => {
                    const sectionLines = section.trim().split('\n');
                    if (sectionLines.length < 3) return;

                    const teamTitle = sectionLines[0].trim();
                    const players = [];
                    let hasHighProb = false;

                    for (let i = 3; i < sectionLines.length; i++) {
                        const line = sectionLines[i];
                        if (!line.includes('|')) continue;

                        const parts = line.split('|').map(p => p.trim());
                        const name = parts[0];
                        const prob90Day = parts[1];
                        const prob2Year = parts[2];
                        
                        const prob90DayValue = parseFloat(prob90Day);
                        const prob2YearValue = parseFloat(prob2Year);

                        const isHigh = (prob90DayValue >= 50) || (prob2YearValue >= 50);
                        if (isHigh) {
                            hasHighProb = true;
                        }

                        players.push({ name, prob90Day, prob2Year, isHigh });
                    }
                    teamsData.push({ title: teamTitle, players, hasHighProb });
                });
                
                const gameHasHighProb = teamsData.some(t => t.hasHighProb);
                games.push({ title: gameTitle, teams: teamsData, hasHighProb: gameHasHighProb });
            });

            return games;
        }

        /**
         * Renders the parsed game data into HTML cards and injects them into the DOM.
         * @param {Array<Object>} gamesData - The array of game objects from parseReport.
         */
        function renderReport(gamesData) {
            const container = document.getElementById('report-container');
            container.innerHTML = ''; // Clear previous content

            gamesData.forEach(game => {
                const gameCard = document.createElement('div');
                gameCard.className = 'card overflow-hidden';
                gameCard.dataset.hasHighProb = game.hasHighProb;

                let teamsHtml = '';
                game.teams.forEach(team => {
                    let playersHtml = '';
                    team.players.forEach(player => {
                        const highlightClass = player.isHigh ? 'highlight' : '';
                        const prob90DayClass = player.prob90Day.toLowerCase().includes('low data') ? 'low-data' : '';
                        const prob2YearClass = player.prob2Year.toLowerCase().includes('low data') ? 'low-data' : '';
                        
                        playersHtml += `
                            <tr class="player-row ${highlightClass}" data-is-high="${player.isHigh}">
                                <td class="py-2 px-4 border-b border-gray-200 text-sm player-name">${player.name}</td>
                                <td class="py-2 px-4 border-b border-gray-200 text-sm text-center ${prob90DayClass}">${player.prob90Day}</td>
                                <td class="py-2 px-4 border-b border-gray-200 text-sm text-center ${prob2YearClass}">${player.prob2Year}</td>
                            </tr>
                        `;
                    });

                    teamsHtml += `
                        <div class="p-4">
                            <h3 class="font-semibold text-gray-700 text-md mb-2">${team.title}</h3>
                            <div class="overflow-x-auto">
                                <table class="min-w-full bg-white">
                                    <thead class="table-header">
                                        <tr>
                                            <th class="py-2 px-4 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Batter</th>
                                            <th class="py-2 px-4 border-b-2 border-gray-200 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider">90-Day Prob</th>
                                            <th class="py-2 px-4 border-b-2 border-gray-200 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider">2-Year Prob</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${playersHtml}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                });

                gameCard.innerHTML = `
                    <div class="bg-gray-800 text-white p-4">
                        <h2 class="font-bold text-lg">${game.title}</h2>
                    </div>
                    <div class="divide-y divide-gray-200">
                        ${teamsHtml}
                    </div>
                `;
                container.appendChild(gameCard);
            });
        }

        let isHighlightOnly = false;
        const toggleBtn = document.getElementById('toggle-highlight-btn');
        const noDataMessage = document.getElementById('no-data-message');

        /**
         * Toggles the view between showing all players and only high-probability players.
         */
        function toggleHighlightView() {
            isHighlightOnly = !isHighlightOnly;
            
            const gameCards = document.querySelectorAll('#report-container .card');
            let visibleCards = 0;

            gameCards.forEach(card => {
                if (isHighlightOnly) {
                    // Hide games that have no high-probability players
                    if (card.dataset.hasHighProb === 'true') {
                        card.style.display = 'block';
                        visibleCards++;
                    } else {
                        card.style.display = 'none';
                    }

                    // Hide individual player rows that are not high-probability
                    const playerRows = card.querySelectorAll('.player-row');
                    playerRows.forEach(row => {
                        if (row.dataset.isHigh === 'true') {
                            row.style.display = 'table-row';
                        } else {
                            row.style.display = 'none';
                        }
                    });
                } else {
                    // Show all games and all players
                    card.style.display = 'block';
                    visibleCards++;
                    const playerRows = card.querySelectorAll('.player-row');
                    playerRows.forEach(row => {
                        row.style.display = 'table-row';
                    });
                }
            });
            
            // Update button style and text
            if (isHighlightOnly) {
                toggleBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                toggleBtn.classList.add('bg-green-600', 'hover:bg-green-700');
                toggleBtn.textContent = "Show All Players";
            } else {
                toggleBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
                toggleBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
                toggleBtn.textContent = "Toggle High Probability Players";
            }

            // Show a message if no high-probability players are found when toggled
            if (isHighlightOnly && visibleCards === 0) {
                noDataMessage.classList.remove('hidden');
            } else {
                noDataMessage.classList.add('hidden');
            }
        }

        // Initial setup
        document.addEventListener('DOMContentLoaded', () => {
            const parsedData = parseReport(reportText);
            renderReport(parsedData);
            toggleBtn.addEventListener('click', toggleHighlightView);
        });
    </script>
</body>
</html>
