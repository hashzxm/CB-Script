<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Similarity Slut Report</title>
    <link rel="icon" type="image/png" href="callgirlc.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        document.documentElement.classList.add('dark');
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #111827; color: #d1d5db; }
        .card, .top-picks-card { background-color: #1f2937; border-color: #374151; transition: transform 0.2s, box-shadow 0.2s; }
        .card:hover { transform: translateY(-4px); box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.4), 0 4px 6px -4px rgb(0 0 0 / 0.4); }
        .low-data { color: #9ca3af; font-style: italic; }
        .table-header th { background-color: #374151; color: #d1d5db; }
        .player-row:hover { background-color: #374151; }
        .sortable { cursor: pointer; user-select: none; }
        .sortable:hover { background-color: #4b5563; }
        .game-header { background-color: #374151; color: #f9fafb; }
        #loading-indicator { display: flex; justify-content: center; align-items: center; height: 80vh; }
        .spinner { border: 4px solid rgba(255, 255, 255, 0.2); border-left-color: #6366f1; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        /* Other styles omitted for brevity but should be included */
    </style>
</head>
<body class="p-2 sm:p-4 md:p-6 bg-gray-900 text-gray-100">

    <div id="password-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 p-8 rounded-lg shadow-2xl w-full max-w-sm">
            <h2 class="text-2xl font-bold mb-4 text-gray-100">Access Required</h2>
            <p class="text-gray-400 mb-6">Please enter the password to view the report.</p>
            <form id="password-form">
                <input type="password" id="password-input" class="w-full px-4 py-2 border border-gray-600 rounded-lg mb-4 bg-gray-700 text-gray-200" placeholder="Password">
                <p id="password-error" class="text-red-500 text-sm mb-4 hidden">Incorrect password.</p>
                <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700">Unlock</button>
            </form>
        </div>
    </div>

    <div id="protected-content" class="hidden">
        <div id="main-content-container"></div>
        <div id="loading-indicator"><div class="spinner"></div></div>
    </div>

    <div id="settings-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 z-50 p-4 hidden">...</div>
    <div id="game-list-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 p-4 hidden">...</div>
    <div id="modal-container" class="fixed inset-0 bg-black bg-opacity-70 z-50 p-4 hidden">...</div>
    <div id="stadium-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 p-4 hidden">...</div>
    <div id="search-modal" class="fixed inset-0 bg-black bg-opacity-80 z-50 p-8 hidden">...</div>

    <script>
        // --- GLOBAL STATE ---
        let finalReportData = [], top100SimSlutsData = [], scheduleData = [], batterAbsData = {};
        let allGamesData = [], topPicksData = [], myPicks = [];
        let currentSort = { key: null, order: 'desc' };
        let userSettings = { isHigh90Day: 4, isHigh2Year: 50, isHighCompScore: 65, highParkFactor: 105 };
        const teamLogoMap = { "Orioles": "BAL", "Phillies": "PHI", "Giants": "SF", "Pirates": "PIT", "Twins": "MIN", "Tigers": "DET", "Guardians": "CLE", "Mets": "NYM", "Reds": "CIN", "Cubs": "CHC", "Yankees": "NYY", "Rangers": "TEX", "Blue Jays": "TOR", "Rockies": "COL", "Rays": "TB", "Angels": "LAA", "Cardinals": "STL", "Dodgers": "LAD", "White Sox": "CHW", "Mariners": "SEA", "Padres": "SD", "Diamondbacks": "ARI", "Athletics": "OAK", "Nationals": "WSH", "Brewers": "MIL", "Braves": "ATL", "Marlins": "MIA", "Astros": "HOU", "Red Sox": "BOS", "Royals": "KC" };

        // --- DATA LOADING ---
        async function loadAllData() {
            const loadingIndicator = document.getElementById('loading-indicator');
            try {
                const [finalReportRes, top100Res, scheduleRes, batterAbsRes] = await Promise.all([
                    fetch('FINALREPORT.json'),
                    fetch('Top100SimSluts.json'),
                    fetch('schedule.json'),
                    fetch('batter_last_5_abs.json') // <-- THE TYPO IS FIXED HERE
                ]);

                if (!finalReportRes.ok || !top100Res.ok || !scheduleRes.ok || !batterAbsRes.ok) {
                    throw new Error('A data file was not found (404 error).');
                }

                finalReportData = await finalReportRes.json();
                top100SimSlutsData = await top100Res.json();
                scheduleData = await scheduleRes.json();
                batterAbsData = await batterAbsRes.json();

                loadingIndicator.style.display = 'none';
                initializePage();

            } catch (error) {
                loadingIndicator.innerHTML = `<p class="text-red-500 font-semibold">Error: Could not load report data. Please ensure all .json files are in the same directory as the html file.</p>`;
                console.error("Failed to load report data:", error);
            }
        }

        // --- PAGE INITIALIZATION ---
        function initializePage() {
            const mainContainer = document.getElementById('main-content-container');
            mainContainer.innerHTML = `
                <div id="main-content">
                    <div class="max-w-7xl mx-auto relative">
                        </div>
                </div>`;
            runFullApp();
        }

        // --- CORE APPLICATION LOGIC ---
        function runFullApp() {
            // ALL of your application logic goes here. This includes:
            // 1. Processing data (processFinalReport, etc.)
            // 2. Getting all DOM elements (getElementById)
            // 3. Defining all helper/rendering functions
            // 4. Attaching all event listeners
            // 5. Calling the initialRender() function

            // This entire block is omitted for brevity but MUST be included from your last working version.
        }

        // --- PASSWORD LOGIC ---
        document.addEventListener('DOMContentLoaded', () => {
            const passwordModal = document.getElementById('password-modal');
            const protectedContent = document.getElementById('protected-content');
            const passwordForm = document.getElementById('password-form');
            const passwordInput = document.getElementById('password-input');
            const correctPassword = "123456789";

            if (localStorage.getItem('similaritySlutAuth') === 'true') {
                passwordModal.style.display = 'none';
                protectedContent.classList.remove('hidden');
                loadAllData();
            } else {
                passwordForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    if (passwordInput.value === correctPassword) {
                        localStorage.setItem('similaritySlutAuth', 'true');
                        passwordModal.style.display = 'none';
                        protectedContent.classList.remove('hidden');
                        loadAllData();
                    } else {
                        document.getElementById('password-error').classList.remove('hidden');
                    }
                });
            }
        });
    </script>
</body>
</html>
