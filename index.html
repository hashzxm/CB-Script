<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Run Prediction Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* gray-100 */
        }
        .card {
            background-color: white;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .highlight {
            background-color: #d1fae5; /* green-200 */
            font-weight: 600;
        }
        .highlight .player-name {
            color: #065f46; /* green-800 */
        }
        .low-data {
            color: #6b7280; /* gray-500 */
            font-style: italic;
        }
        .table-header th {
            background-color: #f9fafb; /* gray-50 */
        }
        .player-row:hover {
            background-color: #f9fafb; /* gray-50 */
        }
        .toggle-btn {
            transition: background-color 0.3s, color 0.3s;
        }
        .sortable {
            cursor: pointer;
            user-select: none;
        }
        .sortable:hover {
            background-color: #e5e7eb; /* gray-200 */
        }
        .sort-asc::after {
            content: ' ▲';
            font-size: 0.7em;
        }
        .sort-desc::after {
            content: ' ▼';
            font-size: 0.7em;
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">Home Run Prediction Report</h1>
            <p class="text-gray-600 mt-2">August 2, 2025</p>
            <div class="flex justify-center items-center space-x-4 mt-6">
                <button id="toggle-highlight-btn" class="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 toggle-btn">
                    Toggle High Probability Players
                </button>
            </div>
        </header>

        <main id="report-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Game cards will be injected here by JavaScript -->
        </main>
        
        <div id="no-data-message" class="hidden text-center py-16">
            <p class="text-xl text-gray-500">No high probability players found.</p>
        </div>

    </div>

    <script>
        // Store the parsed data globally to avoid re-parsing
        let allGamesData = [];
        let currentSort = { key: null, order: 'desc' };

        // Raw text data from the report
        const reportText = `
================================================================================
                   HOME RUN PREDICTION REPORT FOR 2025-08-02                    
================================================================================
GAME: Dodgers @ Rays (1:10 PM ET)
--------------------------------------------------------------------------------
  Rays Batters vs. Blake Snell (Low Data)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Yandy Díaz                |     Low Data    |      3.19%     
  Ha-Seong Kim              |     Low Data    |      5.25%     
  Brandon Lowe              |     Low Data    |      47.84%    
  Junior Caminero           |     Low Data    |      51.21%    
  Christopher Morel         |     Low Data    |      33.82%    
  Josh Lowe                 |     Low Data    |      18.95%    
  Jonny DeLuca              |     Low Data    |      2.62%     
  Taylor Walls              |     Low Data    |      3.33%     
  Hunter Feduccia           |     Low Data    |      4.58%     

--------------------------------------------------------------------------------
  Dodgers Batters vs. Drew Rasmussen (Last 90d: 129 PA, 18.6% K, 0.115 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Shohei Ohtani             |      83.56%     |      77.88%    
  Freddie Freeman           |      19.10%     |      63.92%    
  Andy Pages                |      10.68%     |      37.96%    
  Michael Conforto          |      8.84%      |      65.44%    
  Tommy Edman               |      0.19%      |      5.93%     
  Mookie Betts              |      0.15%      |      22.74%    
  Teoscar Hernández         |      0.10%      |      86.81%    
  Will Smith                |     Low Data    |     Low Data   

================================================================================
GAME: Orioles @ Cubs (2:20 PM ET)
--------------------------------------------------------------------------------
  Cubs Batters vs. Tomoyuki Sugano (Last 90d: 167 PA, 17.4% K, 0.160 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Pete Crow-Armstrong       |      94.15%     |      78.21%    
  Seiya Suzuki              |      15.20%     |      87.48%    
  Kyle Tucker               |      14.56%     |      90.20%    
  Michael Busch             |      10.39%     |      87.55%    
  Ian Happ                  |      5.78%      |      90.17%    
  Dansby Swanson            |      3.24%      |      21.46%    
  Carson Kelly              |      1.78%      |      84.13%    
  Matt Shaw                 |      0.44%      |      42.90%    
  Nico Hoerner              |      0.04%      |      15.60%    

--------------------------------------------------------------------------------
  Orioles Batters vs. Matt Boyd (Last 90d: 253 PA, 22.5% K, 0.153 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Jackson Holliday          |      60.24%     |      6.53%     
  Colton Cowser             |      41.45%     |      78.22%    
  Coby Mayo                 |      1.32%      |      1.41%     
  Dylan Carlson             |      0.89%      |      65.43%    
  Gunnar Henderson          |      0.65%      |      14.76%    
  Adley Rutschman           |      0.39%      |      76.79%    
  Jordan Westburg           |      0.00%      |      65.55%    
  Tyler O'Neill             |      0.00%      |      93.70%    

================================================================================
GAME: Royals @ Blue Jays (3:07 PM ET)
--------------------------------------------------------------------------------
  Blue Jays Batters vs. Noah Cameron (Last 90d: 219 PA, 23.3% K, 0.118 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Bo Bichette               |      96.07%     |      1.48%     
  Ernie Clement             |      53.45%     |      53.85%    
  Ty France                 |      38.98%     |      3.52%     
  Daulton Varsho            |      0.48%      |      53.84%    
  Tyler Heineman            |      0.01%      |      59.63%    
  Addison Barger            |      0.01%      |      1.09%     
  Vladimir Guerrero         |      0.00%      |      27.65%    
  Leo Jimenez               |      0.00%      |      6.29%     
  Davis Schneider           |      0.00%      |      17.30%    

--------------------------------------------------------------------------------
  Royals Batters vs. Max Scherzer (Last 90d: 59 PA, 40.7% K, 0.093 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Randal Grichuk            |      33.32%     |      51.58%    
  Jonathan India            |      11.19%     |      49.67%    
  Salvador Pérez            |      6.46%      |      84.24%    
  Adam Frazier              |      0.10%      |      0.99%     
  Mike Yastrzemski          |      0.08%      |      35.46%    
  Kyle Isbel                |      0.08%      |      12.94%    
  Vinnie Pasquantino        |      0.04%      |      61.13%    
  Maikel García             |      0.01%      |      15.00%    
  Bobby Witt                |      0.00%      |      89.22%    

================================================================================
GAME: Pirates @ Rockies (3:10 PM ET)
--------------------------------------------------------------------------------
  Rockies Batters vs. Paul Skenes (Last 90d: 157 PA, 29.3% K, 0.075 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Hunter Goodman            |      44.82%     |      71.70%    
  Mickey Moniak             |      13.89%     |      45.87%    
  Ezequiel Tovar            |      7.73%      |      16.57%    
  Jordan Beck               |      1.29%      |      3.28%     
  Brenton Doyle             |      0.08%      |      4.32%     
  Orlando Arcia             |      0.07%      |      40.02%    
  Thairo Estrada            |      0.03%      |      2.13%     
  Tyler Freeman             |      0.00%      |      26.86%    

--------------------------------------------------------------------------------
  Pirates Batters vs. Austin Gomber (Last 90d: 144 PA, 11.8% K, 0.241 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Bryan Reynolds            |      62.47%     |      83.00%    
  Nick Gonzales             |      9.02%      |      64.59%    
  Jared Triolo              |      2.60%      |      9.60%     
  Spencer Horwitz           |      0.02%      |      2.02%     
  Alexander Canario         |      0.01%      |      18.36%    
  Tommy Pham                |      0.01%      |      48.56%    
  Joey Bart                 |      0.00%      |      39.59%    
  Andrew McCutchen          |      0.00%      |      24.79%    
  Isiah Kiner-Falefa        |      0.00%      |      0.79%     

================================================================================
GAME: Brewers @ Nationals (4:05 PM ET)
--------------------------------------------------------------------------------
  Nationals Batters vs. Brandon Woodruff (Last 90d: 36 PA, 44.4% K, 0.257 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Brady House               |      99.88%     |      84.14%    
  Nathaniel Lowe            |      0.32%      |      67.54%    
  Robert Hassell            |      0.23%      |      12.96%    
  Jacob Young               |      0.18%      |      1.17%     
  Riley Adams               |      0.10%      |      58.47%    
  James Wood                |      0.01%      |      45.31%    
  CJ Abrams                 |      0.01%      |      61.33%    

--------------------------------------------------------------------------------
  Brewers Batters vs. Jake Irvin (Last 90d: 161 PA, 16.1% K, 0.185 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Andrew Vaughn             |      96.07%     |      88.29%    
  Joey Ortiz                |      8.98%      |      21.42%    
  William Contreras         |      1.44%      |      77.63%    
  Isaac Collins             |      0.20%      |      0.58%     
  Sal Frelick               |      0.11%      |      0.24%     
  Caleb Durbin              |      0.01%      |      1.16%     
  Christian Yelich          |      0.01%      |      26.54%    
  Brice Turang              |      0.00%      |      52.21%    
  Blake Perkins             |      0.00%      |      23.26%    

================================================================================
GAME: Tigers @ Phillies (4:05 PM ET)
--------------------------------------------------------------------------------
  Phillies Batters vs. Tarik Skubal (Last 90d: 287 PA, 36.2% K, 0.096 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Bryce Harper              |      74.20%     |      13.95%    
  Trea Turner               |      10.88%     |      39.17%    
  J. T. Realmuto            |      0.82%      |      40.22%    
  Kyle Schwarber            |      0.11%      |      59.80%    
  Brandon Marsh             |      0.10%      |      1.00%     
  Nick Castellanos          |      0.02%      |      91.66%    
  Edmundo Sosa              |      0.01%      |      0.48%     
  Otto Kemp                 |      0.00%      |      58.64%    

--------------------------------------------------------------------------------
  Tigers Batters vs. Zack Wheeler (Last 90d: 148 PA, 29.7% K, 0.071 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Kerry Carpenter           |      74.56%     |      90.53%    
  Wenceel Pérez             |      22.71%     |      80.35%    
  Gleyber Torres            |      6.12%      |      0.88%     
  Riley Greene              |      3.90%      |      43.99%    
  Colt Keith                |      0.11%      |      77.37%    
  Dillon Dingler            |      0.09%      |      8.97%     
  Spencer Torkelson         |      0.03%      |      90.35%    
  Javier Báez               |      0.02%      |      33.65%    
  Zach McKinstry            |      0.00%      |      25.91%    

================================================================================
GAME: Twins @ Guardians (4:10 PM ET)
--------------------------------------------------------------------------------
  Guardians Batters vs. Bailey Ober (Last 90d: 131 PA, 19.8% K, 0.248 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Angel Martínez            |      37.53%     |      36.66%    
  Carlos Santana            |      0.43%      |      67.70%    
  Brayan Rocchio            |      0.02%      |      87.68%    
  Kyle Manzardo             |      0.01%      |      81.93%    
  Bo Naylor                 |      0.00%      |      89.50%    
  Gabriel Arias             |      0.00%      |      66.52%    
  Steven Kwan               |      0.00%      |      15.87%    

--------------------------------------------------------------------------------
  Twins Batters vs. Tanner Bibee (Last 90d: 189 PA, 21.7% K, 0.124 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Matt Wallner              |      77.58%     |      67.05%    
  Royce Lewis               |      64.03%     |      82.17%    
  Kody Clemens              |      54.83%     |      94.66%    
  Trevor Larnach            |      45.82%     |      84.19%    
  Ryan Jeffers              |      31.39%     |      74.92%    
  Edouard Julien            |      0.51%      |      14.07%    
  Austin Martin             |      0.36%      |      0.49%     
  Brooks Lee                |      0.05%      |      90.39%    
  Alan Roden                |      0.00%      |      8.18%     

================================================================================
GAME: Rangers @ Mariners (4:10 PM ET)
--------------------------------------------------------------------------------
  Mariners Batters vs. Merrill Kelly (Last 90d: 187 PA, 28.9% K, 0.064 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Jorge Polanco             |      60.92%     |      88.23%    
  Dominic Canzone           |      42.31%     |      81.87%    
  Cole Young                |      3.45%      |      16.16%    
  Josh Naylor               |      3.15%      |      64.68%    
  Julio Rodríguez           |      2.16%      |      89.28%    
  J. P. Crawford            |      0.25%      |      50.91%    
  Randy Arozarena           |      0.01%      |      56.50%    
  Cal Raleigh               |      0.01%      |      91.89%    

================================================================================
GAME: Yankees @ Marlins (4:10 PM ET)
--------------------------------------------------------------------------------
  Marlins Batters vs. Cam Schlittler (Last 90d: 27 PA, 25.9% K, 0.167 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Kyle Stowers              |      87.72%     |      1.77%     
  Graham Pauley             |      1.09%      |      0.54%     
  Xavier Edwards            |      0.23%      |      1.23%     
  Dane Myers                |      0.15%      |      2.97%     
  Otto Lopez                |      0.09%      |      6.30%     
  Liam Hicks                |      0.06%      |      0.74%     
  Agustín Ramírez           |      0.03%      |      32.40%    

--------------------------------------------------------------------------------
  Yankees Batters vs. Eury Pérez (Last 90d: 80 PA, 31.2% K, 0.135 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Jazz Chisholm             |      16.42%     |      21.22%    
  Jasson Domínguez          |      14.34%     |      63.88%    
  Austin Wells              |      3.12%      |      71.31%    
  Trent Grisham             |      1.11%      |      26.55%    
  Cody Bellinger            |      0.44%      |      19.97%    
  Giancarlo Stanton         |      0.19%      |      75.94%    
  Anthony Volpe             |      0.18%      |      80.75%    
  Ryan McMahon              |      0.13%      |      51.37%    
  Ben Rice                  |      0.04%      |      88.74%    

================================================================================
GAME: Giants @ Mets (4:10 PM ET)
--------------------------------------------------------------------------------
  Mets Batters vs. Kai-Wei Teng (Low Data)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Brandon Nimmo             |     Low Data    |      1.74%     
  Francisco Lindor          |     Low Data    |      0.74%     
  Juan Soto                 |     Low Data    |      1.56%     
  Pete Alonso               |     Low Data    |      9.99%     
  Jeff McNeil               |     Low Data    |      44.30%    
  Mark Vientos              |     Low Data    |      12.07%    
  Francisco Álvarez         |     Low Data    |      0.74%     
  Ronny Mauricio            |     Low Data    |      5.98%     

--------------------------------------------------------------------------------
  Giants Batters vs. Kodai Senga (Last 90d: 111 PA, 24.3% K, 0.206 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Casey Schmitt             |      66.18%     |      55.55%    
  Matt Chapman              |      55.16%     |      79.38%    
  Willy Adames              |      19.52%     |      86.76%    
  Heliot Ramos              |      1.47%      |      51.32%    
  Patrick Bailey            |      0.56%      |      4.02%     
  Wilmer Flores             |      0.11%      |      62.44%    
  Rafael Devers             |      0.09%      |      42.00%    
  Jung Hoo Lee              |      0.01%      |      0.89%     

================================================================================
GAME: Astros @ Red Sox (4:10 PM ET)
--------------------------------------------------------------------------------
  Red Sox Batters vs. Colton Gordon (Last 90d: 218 PA, 17.9% K, 0.256 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Ceddanne Rafaela          |      44.17%     |      2.01%     
  Trevor Story              |      25.38%     |      2.03%     
  Carlos Narváez            |      11.35%     |      0.27%     
  Alex Bregman              |      3.16%      |      84.41%    
  Masataka Yoshida          |      0.15%      |      94.65%    
  Jarren Duran              |      0.09%      |      7.03%     
  Roman Anthony             |      0.05%      |      2.32%     
  Rob Refsnyder             |      0.00%      |      10.08%    
  Romy Gonzalez             |      0.00%      |      0.13%     

--------------------------------------------------------------------------------
  Astros Batters vs. Walker Buehler (Last 90d: 109 PA, 16.5% K, 0.278 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Taylor Trammell           |      23.55%     |      39.74%    
  Christian Walker          |      18.70%     |      82.53%    
  Yainer Diaz               |      17.15%     |      85.78%    
  José Altuve               |      2.59%      |      92.42%    
  Jeremy Peña               |      1.47%      |      66.19%    
  Mauricio Dubón            |      0.68%      |      71.18%    
  Cam Smith                 |      0.01%      |      34.68%    

================================================================================
GAME: Braves @ Reds (7:15 PM ET)
--------------------------------------------------------------------------------
  Reds Batters vs. Spencer Strider (Last 90d: 147 PA, 28.6% K, 0.144 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Will Benson               |      86.54%     |      10.90%    
  Austin Hays               |      51.49%     |      38.36%    
  Tyler Stephenson          |      31.06%     |      63.67%    
  Elly De La Cruz           |      1.63%      |      78.83%    
  Spencer Steer             |      1.55%      |      88.31%    
  Matt McLain               |      0.28%      |      38.64%    
  Jake Fraley               |      0.09%      |      9.95%     
  Gavin Lux                 |      0.05%      |      55.04%    

--------------------------------------------------------------------------------
  Braves Batters vs. Chase Burns (Last 90d: 57 PA, 36.8% K, 0.167 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Jurickson Profar          |      75.76%     |      3.80%     
  Drake Baldwin             |      66.17%     |      37.34%    
  Sean Murphy               |      0.59%      |      43.58%    
  Ozzie Albies              |      0.23%      |      1.07%     
  Eli White                 |      0.14%      |      0.31%     
  Austin Riley              |      0.02%      |      30.27%    
  Matt Olson                |      0.01%      |      1.93%     
  Michael Harris            |      0.00%      |      0.49%     

================================================================================
GAME: Diamondbacks @ Athletics (10:05 PM ET)
--------------------------------------------------------------------------------
  Athletics Batters vs. Zac Gallen (Last 90d: 205 PA, 23.9% K, 0.253 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Tyler Soderstrom          |      21.90%     |      62.38%    
  Shea Langeliers           |      10.12%     |      84.75%    
  Lawrence Butler           |      0.52%      |      84.47%    
  Nick Kurtz                |      0.24%      |      1.53%     
  Darell Hernaiz            |      0.08%      |      6.34%     
  Brent Rooker              |      0.05%      |      82.64%    
  Luis Urías                |      0.03%      |      78.55%    
  Gio Urshela               |      0.00%      |      10.40%    

--------------------------------------------------------------------------------
  Diamondbacks Batters vs. J. T. Ginn (Last 90d: 73 PA, 34.2% K, 0.143 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Lourdes Gurriel           |      93.49%     |      33.06%    
  James McCann              |      4.59%      |      21.37%    
  Ketel Marte               |      2.06%      |      27.48%    
  Corbin Carroll            |      1.15%      |      18.24%    
  Alek Thomas               |      0.86%      |      45.31%    
  Adrian Del Castillo       |      0.48%      |      4.92%     
  Blaze Alexander           |      0.10%      |      6.84%     
  Geraldo Perdomo           |      0.07%      |      5.15%     

================================================================================
GAME: White Sox @ Angels (10:07 PM ET)
--------------------------------------------------------------------------------
  Angels Batters vs. Aaron Civale (Last 90d: 135 PA, 13.3% K, 0.168 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Taylor Ward               |      94.39%     |      86.41%    
  Mike Trout                |      82.26%     |      92.96%    
  Jo Adell                  |      77.35%     |      72.07%    
  Yoán Moncada              |      50.04%     |      3.07%     
  Zach Neto                 |      37.21%     |      57.94%    
  Logan O'Hoppe             |      3.30%      |      79.63%    
  LaMonte Wade              |      0.22%      |      85.17%    
  Luis Rengifo              |      0.11%      |      98.12%    
  Nolan Schanuel            |      0.01%      |      71.73%    

--------------------------------------------------------------------------------
  White Sox Batters vs. Kyle Hendricks (Last 90d: 154 PA, 14.9% K, 0.238 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Lenyn Sosa                |      77.88%     |      4.42%     
  Brooks Baldwin            |      26.58%     |      84.87%    
  Miguel Vargas             |      2.85%      |      17.40%    
  Andrew Benintendi         |      0.42%      |      48.17%    
  Mike Tauchman             |      0.05%      |      66.70%    
  Chase Meidroth            |      0.02%      |      1.21%     
  Colson Montgomery         |      0.01%      |      82.77%    
  Luis Robert               |      0.01%      |      33.93%    
  Kyle Teel                 |      0.00%      |      28.61%    

================================================================================
GAME: Cardinals @ Padres (10:10 PM ET)
--------------------------------------------------------------------------------
  Padres Batters vs. Michael McGreevy (Last 90d: 71 PA, 14.1% K, 0.118 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Xander Bogaerts           |      62.22%     |      5.55%     
  Jake Cronenworth          |      0.99%      |      5.09%     
  Manny Machado             |      0.52%      |      0.42%     
  Jackson Merrill           |      0.15%      |      3.42%     
  Fernando Tatís            |      0.10%      |      4.94%     
  Luis Arráez               |      0.06%      |      0.63%     
  Ramón Laureano            |      0.05%      |      4.77%     
  Ryan O'Hearn              |      0.03%      |      6.98%     

--------------------------------------------------------------------------------
  Cardinals Batters vs. Randy Vásquez (Last 90d: 164 PA, 12.2% K, 0.135 ISO)
  Batter                    |   90-Day Prob   |   2-Year Prob  
  ------------------------- | --------------- | ---------------
  Alec Burleson             |      40.28%     |      82.57%    
  Willson Contreras         |      33.28%     |      75.34%    
  Nolan Gorman              |      2.33%      |      75.44%    
  Brendan Donovan           |      0.23%      |      53.81%    
  Iván Herrera              |      0.05%      |      6.82%     
  Yohel Pozo                |      0.04%      |      4.24%     
  Masyn Winn                |      0.04%      |      23.61%    
  Jordan Walker             |      0.02%      |      37.43%    
  Victor Scott              |      0.01%      |      39.81%    

================================================================================
        `;

        /**
         * Parses the raw text of the home run report into a structured JavaScript object.
         * This function also converts probability strings to numbers for sorting.
         * @param {string} text - The raw text content of the report.
         * @returns {Array<Object>} An array of game objects, each containing details and player stats.
         */
        function parseReport(text) {
            const games = [];
            const gameBlocks = text.split('================================================================================').filter(b => b.trim().startsWith('GAME:'));

            gameBlocks.forEach(block => {
                const lines = block.trim().split('\n');
                const gameTitleLine = lines.find(line => line.startsWith('GAME:'));
                if (!gameTitleLine) return;
                const gameTitle = gameTitleLine.replace('GAME: ', '').trim();
                
                const teamSections = block.split('--------------------------------------------------------------------------------').slice(1);
                const teamsData = [];

                teamSections.forEach((section, teamIndex) => {
                    const sectionLines = section.trim().split('\n');
                    if (sectionLines.length < 4) return;

                    const teamTitle = sectionLines[0].trim();
                    const players = [];
                    let hasHighProb = false;

                    for (let i = 3; i < sectionLines.length; i++) {
                        const line = sectionLines[i];
                        if (!line.includes('|') || line.includes('---')) continue;

                        const parts = line.split('|').map(p => p.trim());
                        if (parts.length < 3) continue;

                        const name = parts[0];
                        const prob90DayStr = parts[1];
                        const prob2YearStr = parts[2];
                        
                        const prob90DayValue = prob90DayStr.toLowerCase().includes('low data') ? -1 : parseFloat(prob90DayStr);
                        const prob2YearValue = prob2YearStr.toLowerCase().includes('low data') ? -1 : parseFloat(prob2YearStr);

                        const isHigh = (prob90DayValue >= 50) || (prob2YearValue >= 50);
                        if (isHigh) hasHighProb = true;

                        players.push({ name, prob90DayStr, prob2YearStr, prob90DayValue, prob2YearValue, isHigh });
                    }
                    if (players.length > 0) {
                        teamsData.push({ id: `${gameTitle}-${teamIndex}`, title: teamTitle, players, hasHighProb });
                    }
                });
                
                if (teamsData.length > 0) {
                    const gameHasHighProb = teamsData.some(t => t.hasHighProb);
                    games.push({ title: gameTitle, teams: teamsData, hasHighProb: gameHasHighProb });
                }
            });

            return games;
        }

        /**
         * Renders the parsed game data into HTML cards and injects them into the DOM.
         * @param {Array<Object>} gamesData - The array of game objects from parseReport.
         */
        function renderReport(gamesData) {
            const container = document.getElementById('report-container');
            container.innerHTML = ''; // Clear previous content

            gamesData.forEach(game => {
                const gameCard = document.createElement('div');
                gameCard.className = 'card overflow-hidden';
                gameCard.dataset.hasHighProb = game.hasHighProb;

                let teamsHtml = '';
                game.teams.forEach(team => {
                    let playersHtml = '';
                    team.players.forEach(player => {
                        const highlightClass = player.isHigh ? 'highlight' : '';
                        const prob90DayClass = player.prob90DayStr.toLowerCase().includes('low data') ? 'low-data' : '';
                        const prob2YearClass = player.prob2YearStr.toLowerCase().includes('low data') ? 'low-data' : '';
                        
                        playersHtml += `
                            <tr class="player-row ${highlightClass}" data-is-high="${player.isHigh}">
                                <td class="py-2 px-4 border-b border-gray-200 text-sm player-name">${player.name}</td>
                                <td class="py-2 px-4 border-b border-gray-200 text-sm text-center ${prob90DayClass}">${player.prob90DayStr}</td>
                                <td class="py-2 px-4 border-b border-gray-200 text-sm text-center ${prob2YearClass}">${player.prob2YearStr}</td>
                            </tr>
                        `;
                    });
                    
                    const sort90DayClass = currentSort.key === 'prob90DayValue' ? (currentSort.order === 'desc' ? 'sort-desc' : 'sort-asc') : '';
                    const sort2YearClass = currentSort.key === 'prob2YearValue' ? (currentSort.order === 'desc' ? 'sort-desc' : 'sort-asc') : '';

                    teamsHtml += `
                        <div class="p-4" data-team-id="${team.id}">
                            <h3 class="font-semibold text-gray-700 text-md mb-2">${team.title}</h3>
                            <div class="overflow-x-auto">
                                <table class="min-w-full bg-white">
                                    <thead class="table-header">
                                        <tr>
                                            <th class="py-2 px-4 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Batter</th>
                                            <th class="py-2 px-4 border-b-2 border-gray-200 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider sortable ${sort90DayClass}" data-sort-key="prob90DayValue">90-Day Prob</th>
                                            <th class="py-2 px-4 border-b-2 border-gray-200 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider sortable ${sort2YearClass}" data-sort-key="prob2YearValue">2-Year Prob</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${playersHtml}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                });

                gameCard.innerHTML = `
                    <div class="bg-gray-800 text-white p-4">
                        <h2 class="font-bold text-lg">${game.title}</h2>
                    </div>
                    <div class="divide-y divide-gray-200">
                        ${teamsHtml}
                    </div>
                `;
                container.appendChild(gameCard);
            });
        }
        
        /**
         * Sorts a specific team's player list and re-renders that table.
         * @param {string} teamId - The unique ID of the team to sort.
         * @param {string} sortKey - The key to sort by ('prob90DayValue' or 'prob2YearValue').
         */
        function sortTeam(teamId, sortKey) {
             // Find the team data
            const teamData = allGamesData.flatMap(g => g.teams).find(t => t.id === teamId);
            if (!teamData) return;

            // Determine sort order
            const order = (currentSort.key === sortKey && currentSort.order === 'desc') ? 'asc' : 'desc';
            currentSort = { key: sortKey, order };

            // Sort the players
            teamData.players.sort((a, b) => {
                const valA = a[sortKey];
                const valB = b[sortKey];
                return order === 'desc' ? valB - valA : valA - valB;
            });

            // Re-render just the affected table
            const teamContainer = document.querySelector(`[data-team-id="${teamId}"]`);
            if (!teamContainer) return;
            
            const tableBody = teamContainer.querySelector('tbody');
            tableBody.innerHTML = ''; // Clear existing rows

            let playersHtml = '';
            teamData.players.forEach(player => {
                const highlightClass = player.isHigh ? 'highlight' : '';
                const prob90DayClass = player.prob90DayStr.toLowerCase().includes('low data') ? 'low-data' : '';
                const prob2YearClass = player.prob2YearStr.toLowerCase().includes('low data') ? 'low-data' : '';
                
                playersHtml += `
                    <tr class="player-row ${highlightClass}" data-is-high="${player.isHigh}">
                        <td class="py-2 px-4 border-b border-gray-200 text-sm player-name">${player.name}</td>
                        <td class="py-2 px-4 border-b border-gray-200 text-sm text-center ${prob90DayClass}">${player.prob90DayStr}</td>
                        <td class="py-2 px-4 border-b border-gray-200 text-sm text-center ${prob2YearClass}">${player.prob2YearStr}</td>
                    </tr>
                `;
            });
            tableBody.innerHTML = playersHtml;

            // Update sort indicators
            teamContainer.querySelectorAll('.sortable').forEach(th => th.classList.remove('sort-asc', 'sort-desc'));
            const activeHeader = teamContainer.querySelector(`[data-sort-key="${sortKey}"]`);
            activeHeader.classList.add(order === 'desc' ? 'sort-desc' : 'sort-asc');
        }


        let isHighlightOnly = false;
        const toggleBtn = document.getElementById('toggle-highlight-btn');
        const noDataMessage = document.getElementById('no-data-message');

        function toggleHighlightView() {
            isHighlightOnly = !isHighlightOnly;
            
            const gameCards = document.querySelectorAll('#report-container .card');
            let visibleCards = 0;

            gameCards.forEach(card => {
                if (isHighlightOnly) {
                    if (card.dataset.hasHighProb === 'true') {
                        card.style.display = 'block';
                        visibleCards++;
                    } else {
                        card.style.display = 'none';
                    }
                    const playerRows = card.querySelectorAll('.player-row');
                    playerRows.forEach(row => {
                        row.style.display = row.dataset.isHigh === 'true' ? 'table-row' : 'none';
                    });
                } else {
                    card.style.display = 'block';
                    visibleCards++;
                    const playerRows = card.querySelectorAll('.player-row');
                    playerRows.forEach(row => {
                        row.style.display = 'table-row';
                    });
                }
            });
            
            if (isHighlightOnly) {
                toggleBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                toggleBtn.classList.add('bg-green-600', 'hover:bg-green-700');
                toggleBtn.textContent = "Show All Players";
            } else {
                toggleBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
                toggleBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
                toggleBtn.textContent = "Toggle High Probability Players";
            }

            noDataMessage.classList.toggle('hidden', !(isHighlightOnly && visibleCards === 0));
        }

        // Initial setup
        document.addEventListener('DOMContentLoaded', () => {
            allGamesData = parseReport(reportText);
            renderReport(allGamesData);
            
            toggleBtn.addEventListener('click', toggleHighlightView);

            // Event delegation for sorting
            const container = document.getElementById('report-container');
            container.addEventListener('click', (e) => {
                const header = e.target.closest('.sortable');
                if (header) {
                    const sortKey = header.dataset.sortKey;
                    const teamContainer = header.closest('[data-team-id]');
                    const teamId = teamContainer.dataset.teamId;
                    sortTeam(teamId, sortKey);
                }
            });
        });
    </script>
</body>
</html>
